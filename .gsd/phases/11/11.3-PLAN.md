---
phase: 11
plan: 3
wave: 2
---

# Plan 11.3: AI Auto-creation & Detail Drill-down

## Objective
Enable deep exploration of categories with advanced filtering, pagination, and automatic expansion of the category catalog during AI imports.

## Context
- .gsd/ROADMAP.md
- src/features/analytics/pages/CategoryDetail.tsx
- src/features/expenses/pages/ImportExpenses.tsx
- src/features/analytics/hooks/useCategoryStats.ts

## Tasks

<task type="auto">
  <name>AI Category Discovery Logic</name>
  <files>
    - src/features/expenses/pages/ImportExpenses.tsx
  </files>
  <action>
    Modify the AI processing logic:
    - When Gemini returns a category name, check the database (via `useCategories`) if it exists.
    - If it's a new name, automatically create it in the user's categories.
    - Assign a random but harmonious color and the `LayoutGrid` icon by default.
  </action>
  <verify>Import a receipt with a non-standard category (e.g. "Sushi") and verify it appears in the categories list.</verify>
  <done>New categories are created automatically during imports.</done>
</task>

<task type="auto">
  <name>Advanced Category Detail</name>
  <files>
    - src/features/analytics/pages/CategoryDetail.tsx
  </files>
  <action>
    Upgrade the `CategoryDetail` view:
    - **Pagination**: Implement numeric pagination with "Previous/Next" using Supabase `.range()`.
    - **Filtering**: Add a filter bar for Date Range (from/to), Min/Max Amount, and Scope (Total vs Personal).
    - **Quick Add**: Integrate a button to open the `TransactionModal` with the current category pre-selected.
  </action>
  <verify>Test filters and pagination with multiple mock or real transactions.</verify>
  <done>Category detail view supports large datasets and granular exploration.</done>
</task>

## Success Criteria
- [ ] AI imports create new categories as needed.
- [ ] Category Detail page supports numeric pagination and filtering.
- [ ] Users can add transactions directly from a category page.
