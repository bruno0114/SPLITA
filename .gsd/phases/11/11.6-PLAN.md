# Plan 11.6: Advanced Browsing & Insights

## Objective
Implement a high-performance, premium browsing experience for Personal Finance with advanced filters, infinite scroll, and data visualization. Ensure data hygiene with category merging.

## Tasks

### 1. Category Hygiene & Database Integrity üßπ
- [ ] Create a migration to merge duplicate categories (same name per user).
- [ ] Add a unique constraint `unique_category_name_per_user` to the `categories` table.
- [ ] Update `useCategories` hook to prevent creating duplicates in the UI.

### 2. Premium Filter Components üîç
- [ ] **PremiumDatePicker**: Create a custom range date picker component matching the glassmorphic design.
- [ ] **PremiumToggleGroup**: Implement a multi-select toggle for filtering by type (Gasto/Ingreso) or scope.
- [ ] Integrate these filters into `PersonalFinance.tsx` and `CategoryDetail.tsx`.
- [ ] Add an "Active Filter" indicator/icon with a pulse animation during data fetching.

### 3. Infinite Scroll & UX üìú
- [ ] Modify `usePersonalTransactions` and `useTransactions` hooks to support pagination/limit/offset.
- [ ] Implement an `IntersectionObserver` in `PersonalFinance.tsx` to trigger "Load More".
- [ ] Add a "Cargando movimientos..." skeleton or glassmorphic loader at the bottom.
- [ ] Ensure re-categorization actions (single or bulk) use `Framer Motion`'s `layout` and `AnimatePresence` for "Fade Up" effects without changing pages.

### 4. Expenditure Evolution Chart üìä
- [ ] Implement a **Stacked Bar Chart** (using `recharts` or similar) in `PersonalFinance.tsx`.
- [ ] Configure the chart to be responsive to the active date and category filters.
- [ ] Add clear month/reference labels and premium tooltips.

### 5. Group Split Reference üë•
- [ ] Update `TransactionCard` to show a clear "Split de [Grupo]" badge for items derived from group expenses.
- [ ] Ensure these items are labeled as "Group" context in personal views but link back to the group if clicked.

## Verification Criteria
- [ ] No more duplicate categories with the same name for a single user.
- [ ] Infinite scroll loads at least 3 pages of data without glitches.
- [ ] Applying a date filter updates both the list and the chart instantly.
- [ ] Breadcrumbs/Navigation remain stable during bulk category moves.
