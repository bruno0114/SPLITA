---
phase: 12
plan: 2
wave: 1
---

# Plan 12.2: Premium UI & AI Features

## Objective
Implement advanced wealth projections, optimize AI advice delivery, and improve API key management.

## Context
- src/features/dashboard/components/ProjectionCard.tsx
- src/services/ai.ts
- src/features/settings/pages/Settings.tsx

## Tasks

<task type="auto">
  <name>Feature: Advanced Projections</name>
  <files>
    src/features/dashboard/components/ProjectionsModal.tsx
    src/features/dashboard/components/ProjectionCard.tsx
  </files>
  <action>
    1. Create 'ProjectionsModal' component:
       - Inputs: Monthly savings (read-only from dashboard context?), investment amount.
       - Toggles: Conservative (ETF 8%), Aggressive (Crypto 12%).
       - Visualization: Simple chart or list showing 6 months, 1 year, 5 years, 10 years.
    2. Integrate into 'ProjectionCard' via a "Ver proyección detallada" button.
  </action>
  <verify>
    Browser verification: Click button, modal opens, numbers update based on toggles.
  </verify>
  <done>
    Projections modal functional and integrated.
  </done>
</task>

<task type="auto">
  <name>Feature: AI Advice Caching</name>
  <files>
    src/features/dashboard/hooks/useFinancialAdvice.ts
    src/features/dashboard/pages/EconomicHealth.tsx
  </files>
  <action>
    1. Create 'useFinancialAdvice' hook (or update existing logic).
    2. Logic:
       - Check 'daily_insights' table for user_id + today's date.
       - If exists, return content.
       - If not, call Gemini API, save to 'daily_insights', return content.
    3. Update 'EconomicHealth' to use this hook and add a "Refresh" button (force new generation).
  </action>
  <verify>
    Verify network tab: first load calls Gemini, second load (refresh page) calls DB only.
  </verify>
  <done>
    AI advice is cached daily.
  </done>
</task>

<task type="auto">
  <name>Improvement: API Key UX</name>
  <files>
    src/features/settings/pages/Settings.tsx
  </files>
  <action>
    Update Settings page:
    - Add "Test Key" button next to API Key input.
    - Show distinct states: "Validating...", "Valid ✅", "Invalid ❌".
    - Use 'validateGeminiKey' from services/ai.ts.
  </action>
  <verify>
    Enter valid/invalid keys and check UI feedback.
  </verify>
  <done>
    API Key validation is explicit and user-friendly.
  </done>
</task>

## Success Criteria
- [ ] Projections Modal shows valid compound interest data.
- [ ] AI Advice persists across page reloads for the same day.
- [ ] Users can validate their Gemini Key in Settings.
